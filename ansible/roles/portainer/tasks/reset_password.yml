- name: Stop portainer
  community.docker.docker_container:
    name: portainer
    state: stopped


### NOTE: Easier to get stdout/stderr from a raw command than from 'docker_container'
- name: Reset password
  ansible.builtin.command:
    docker run --rm -v portainer_data:/data portainer/helper-reset-password
  register: portainer_reset_password
  changed_when: portainer_reset_password.rc != 0

- name: Show new password
  ansible.builtin.debug:
    var: portainer_reset_password.stderr_lines
