---

all:
  vars:
    ### Network settings
    # subnet: "YOUR_SUBNET_HERE"
    subnet: "10.1.1"
    ip: "{{ subnet }}.{{ id }}"
    # mask: "255.255.255.0"
    gateway: "{{ subnet }}.1"

    ### DNS settings
    domain: test.lan
    fqdn: "{{ inventory_hostname }}.{{ domain }}"
    dns: "{{ hostvars['pihole'].ip }}"

    ### Ansible vars
    ansible_ssh_host: "{{ ip }}"
    ansible_user: root
    ansible_ssh_common_args: -o StrictHostKeyChecking=no

    ### Misc. vars
    # repo_dir: "{{ inventory_dir | dirname }}"
    prox_ct_template_dir: /var/lib/vz/template/cache
    prox_iso_dir: /var/lib/vz/template/iso
    ssh_key_path: ~/.ssh/proxmox_automation_{{ inventory_hostname }}
    # ssh_key: "{{ lookup('file', ssh_key_path) }}"

  hosts:
    prox:
      # id: "YOUR_HOST_IP_AFFIX_HERE"
      id: 240
      # ansible_ssh_host: "{{ subnet }}.{{ id }}"
      # ansible_user: root
      password: "{{ lookup('file', './../password.txt') }}"
      port: 8006

  children:
    cts:
      hosts:
        base:
          id: 241
          # ansible_ssh_host: "{{ subnet }}.{{ id }}"
          # ansible_user: root
          base_packages: [git, curl, unzip, idn2, htop, tree]

        pihole:
          id: 242
          # ansible_ssh_host: "{{ subnet }}.{{ id }}"
          # ansible_user: root
          # ansible_ssh_private_key_file: "TODO"
          port: 80
          cname: "{{ domain }}"

    vms:
      hosts:
        portainer:
          id: 250
          ### 22.04 LTS
          # chosen_iso: ubuntu-22.04-live-server-amd64.iso
          cloud_init_img_url: https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img
          cloud_init_img: "ubuntu-{{ cloud_init_img_url | basename }}"

    # docker_containers:
    #   hosts:
    #     scraper:
    #       id: 125
    #       # port: 80
    #       port: 5000
    #       ct_cores: 2
    #       ct_memory: 1024
    #       ct_swap: 100
    #       # required_packages: [apache2,php,libapache2-mod-php,python3-pip,firefox,firefox-geckodriver]
    #       # required_packages: [apache2,php,libapache2-mod-php,python3-pip,firefox]
    #       required_packages: [python3-pip,firefox,firefox-geckodriver]
    #       # additional_ports: [3306, 33060]
    #       # ct_features:
    #       # - fuse=1
    #       # - mount=nfs
    #       # - nesting=1
    #       # ct_custom_configs:
    #       # - "lxc.mount.entry = /dev/fuse dev/fuse none bind,create=file 0 0"
